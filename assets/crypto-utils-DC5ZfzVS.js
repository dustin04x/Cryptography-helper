function A(t,r){return t.replace(/[a-zA-Z]/g,o=>{const n=o<="Z"?65:97;let s=((o.charCodeAt(0)-n+r)%26+26)%26;return String.fromCharCode(s+n)})}function S(t,r,o=!0){if(!r)return t;const n=r.replace(/[^a-zA-Z]/g,"").toUpperCase();if(!n)return t;let e="",s=0;for(let i=0;i<t.length;i++){const a=t[i];if(/[a-zA-Z]/.test(a)){const c=a<="Z",l=a.toUpperCase().charCodeAt(0)-65,f=n[s%n.length].charCodeAt(0)-65;let h;o?h=(l+f)%26:h=(l-f+26)%26;const p=String.fromCharCode(h+65);e+=c?p:p.toLowerCase(),s++}else e+=a}return e}function U(t){return t.replace(/[a-zA-Z]/g,r=>{const o=r<="Z",e=90-(r.toUpperCase().charCodeAt(0)-65),s=String.fromCharCode(e);return o?s:s.toLowerCase()})}function b(t){return A(t,13)}function K(t,r,o=!0){if(r<=1)return t;if(o){const n=Array(r).fill(null).map(()=>[]);let e=0,s=1;for(let i=0;i<t.length;i++)n[e].push(t[i]),e+=s,(e===r-1||e===0)&&(s=-s);return n.map(i=>i.join("")).join("")}else{const n=Array(r).fill(null).map(()=>Array(t.length).fill(null));let e=0,s=1;for(let c=0;c<t.length;c++)n[e][c]="*",e+=s,(e===r-1||e===0)&&(s=-s);let i=0;for(let c=0;c<r;c++)for(let l=0;l<t.length;l++)n[c][l]==="*"&&i<t.length&&(n[c][l]=t[i++]);let a="";e=0,s=1;for(let c=0;c<t.length;c++)a+=n[e][c],e+=s,(e===r-1||e===0)&&(s=-s);return a}}function Z(t,r,o=!0){const n="ABCDEFGHIKLMNOPQRSTUVWXYZ",e=r.toUpperCase().replace(/[^A-Z]/g,"").replace(/J/g,"I"),s=[...new Set(e.split(""))],i=n.split("").filter(p=>!s.includes(p)),a=[...s,...i],c={};for(let p=0;p<25;p++)c[a[p]]=[Math.floor(p/5),p%5];let l=t.toUpperCase().replace(/[^A-Z]/g,"").replace(/J/g,"I");const f=[];for(let p=0;p<l.length;p+=2){let d=l[p];p+1<l.length?l[p]===l[p+1]?(d+="X",p--):d+=l[p+1]:d+="X",f.push(d)}let h="";for(const p of f){const[d,u]=c[p[0]],[C,y]=c[p[1]];if(d===C){const g=o?(u+1)%5:(u-1+5)%5,w=o?(y+1)%5:(y-1+5)%5;h+=a[d*5+g]+a[C*5+w]}else if(u===y){const g=o?(d+1)%5:(d-1+5)%5,w=o?(C+1)%5:(C-1+5)%5;h+=a[g*5+u]+a[w*5+y]}else h+=a[d*5+y]+a[C*5+u]}return h}function E(t,r,o=!0){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ",e=r.toUpperCase().replace(/[^A-Z]/g,"");if(e.length!==26||new Set(e).size!==26)throw new Error("Key must contain all 26 letters exactly once");const s=o?n:e,i=o?e:n;return t.replace(/[a-zA-Z]/g,a=>{const c=a<="Z",l=a.toUpperCase(),f=s.indexOf(l);if(f===-1)return a;const h=i[f];return c?h:h.toLowerCase()})}function M(t,r,o,n=!0){const e=(i,a)=>a===0?i:e(a,i%a);if(e(r,26)!==1)throw new Error('Parameter "a" must be coprime with 26');const s=(i,a)=>{for(let c=1;c<a;c++)if(i*c%a===1)return c;return 1};return t.replace(/[a-zA-Z]/g,i=>{const a=i<="Z",c=i.toUpperCase().charCodeAt(0)-65;let l;n?l=(r*c+o)%26:l=s(r,26)*(c-o+26)%26;const f=String.fromCharCode(l+65);return a?f:f.toLowerCase()})}function v(t,r=!0){const o={A:".-",B:"-...",C:"-.-.",D:"-..",E:".",F:"..-.",G:"--.",H:"....",I:"..",J:".---",K:"-.-",L:".-..",M:"--",N:"-.",O:"---",P:".--.",Q:"--.-",R:".-.",S:"...",T:"-",U:"..-",V:"...-",W:".--",X:"-..-",Y:"-.--",Z:"--..",0:"-----",1:".----",2:"..---",3:"...--",4:"....-",5:".....",6:"-....",7:"--...",8:"---..",9:"----."," ":"/"};if(r)return t.toUpperCase().split("").map(n=>o[n]||n).join(" ");{const n={};return Object.entries(o).forEach(([e,s])=>{n[s]=e}),t.split(" ").map(e=>n[e]||e).join("")}}function D(t,r=!0){return r?t.split("").map(o=>o.charCodeAt(0).toString(2).padStart(8,"0")).join(" "):t.split(" ").map(o=>String.fromCharCode(parseInt(o,2))).join("")}async function I(t,r){const o=new TextEncoder,n=o.encode(t),e=crypto.getRandomValues(new Uint8Array(16)),s=await crypto.subtle.importKey("raw",o.encode(r),"PBKDF2",!1,["deriveKey"]),i=await crypto.subtle.deriveKey({name:"PBKDF2",salt:e,iterations:1e5,hash:"SHA-256"},s,{name:"AES-GCM",length:256},!1,["encrypt"]),a=crypto.getRandomValues(new Uint8Array(12)),c=await crypto.subtle.encrypt({name:"AES-GCM",iv:a},i,n),l=new Uint8Array(e.length+a.length+c.byteLength);return l.set(e,0),l.set(a,e.length),l.set(new Uint8Array(c),e.length+a.length),btoa(String.fromCharCode(...l))}async function j(t,r){try{const o=new Uint8Array(atob(t).split("").map(h=>h.charCodeAt(0))),n=o.slice(0,16),e=o.slice(16,28),s=o.slice(28),i=new TextEncoder,a=await crypto.subtle.importKey("raw",i.encode(r),"PBKDF2",!1,["deriveKey"]),c=await crypto.subtle.deriveKey({name:"PBKDF2",salt:n,iterations:1e5,hash:"SHA-256"},a,{name:"AES-GCM",length:256},!1,["decrypt"]),l=await crypto.subtle.decrypt({name:"AES-GCM",iv:e},c,s);return new TextDecoder().decode(l)}catch{throw new Error("Decryption failed. Check your password and data.")}}async function B(t,r){const n=new TextEncoder().encode(t);let e;return r==="MD5"?m(t):(e=await crypto.subtle.digest(r,n),Array.from(new Uint8Array(e)).map(i=>i.toString(16).padStart(2,"0")).join(""))}function m(t){let r=0;for(let n=0;n<t.length;n++){const e=t.charCodeAt(n);r=(r<<5)-r+e,r=r&r}return Math.abs(r).toString(16).padStart(32,"0").substring(0,32)}export{M as a,D as b,b as c,U as d,I as e,j as f,A as g,B as h,v as m,Z as p,K as r,E as s,S as v};
